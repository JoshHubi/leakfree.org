<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from leakfree.org/t/replacing-npc-models-mini-tutorial-discovery-log/62109 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 18 Jan 2021 09:24:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Replacing NPC Models - Mini-Tutorial &amp; Discovery Log - General Development - Leakfree</title>
    <meta name="description" content="This Xen-bloodied guard is the first thing I’ve done with a technique I’ve just discovered for replacing the character models on NPCs by keyvalue- i.e., using values settable on an NPC-by-NPC basis in the hammer editor&amp;hellip;">
    <meta name="generator" content="Discourse 2.6.0.beta5 - https://github.com/discourse/discourse version b9fb1cebcd8c8dc34800692fd6f8b72c47b51ad3">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1b69109125d4946f223f71d45e038e4e8e7410f9_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/1/1b69109125d4946f223f71d45e038e4e8e7410f9_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="62109.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://leakfree.org","potentialAction":{"@type":"SearchAction","target":"https://leakfree.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Leakfree Search">

      <link href="../../stylesheets/desktop_8_78a84313b1758221d1fdcffd1499666af5b5fdab.css_%3b%20filename_%3dUTF-8%27%27desktop_8_78a84313b1758221d1fdcffd1499666af5b5fdabd733.css?__ws=leakfree.org" media="all" rel="stylesheet" data-target="desktop" data-theme-id="11"/>
      <link href="../../stylesheets/desktop_theme_11_bcef0414ba3b66792586d18ce571f192263e1732.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_11_bcef0414ba3b66792586d18ce571f192263e1732d733.css?__ws=leakfree.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="11"/>
    <script data-ad-client="ca-pub-2079330348735278" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Replacing NPC Models - Mini-Tutorial &amp; Discovery Log&#39;" href="62109.rss" />
    <meta property="og:site_name" content="Leakfree" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://leakfree.org/uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_1024x576.jpeg" />
<meta property="og:image" content="https://leakfree.org/uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_1024x576.jpeg" />
<meta property="og:url" content="https://leakfree.org/t/replacing-npc-models-mini-tutorial-discovery-log/62109" />
<meta name="twitter:url" content="https://leakfree.org/t/replacing-npc-models-mini-tutorial-discovery-log/62109" />
<meta property="og:title" content="Replacing NPC Models - Mini-Tutorial &amp; Discovery Log" />
<meta name="twitter:title" content="Replacing NPC Models - Mini-Tutorial &amp; Discovery Log" />
<meta property="og:description" content="This Xen-bloodied guard is the first thing I’ve done with a technique I’ve just discovered for replacing the character models on NPCs by keyvalue- i.e., using values settable on an NPC-by-NPC basis in the hammer editor.  Those of you familiar with Black Mesa modding will be aware that this can already be done with the character manifest, a script file that the game consults and, if it finds a name matching the NPC in the map, will give the NPC features as described in the entry in the file. T..." />
<meta name="twitter:description" content="This Xen-bloodied guard is the first thing I’ve done with a technique I’ve just discovered for replacing the character models on NPCs by keyvalue- i.e., using values settable on an NPC-by-NPC basis in the hammer editor.  Those of you familiar with Black Mesa modding will be aware that this can already be done with the character manifest, a script file that the game consults and, if it finds a name matching the NPC in the map, will give the NPC features as described in the entry in the file. T..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />
<meta property="article:published_time" content="2019-01-23T23:52:58+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    








<script src="../../theme-javascripts/451263f573ec5e4eb9c81f3085c4024d360f28d7.js_%3b%20filename_%3dUTF-8%27%27451263f573ec5e4eb9c81f3085c4024d360f28d7d733.js?__ws=leakfree.org"></script>
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/b/b4f2bc6e5e04e842eae8b788313c606f873a973b.png" alt="Leakfree" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="62109.html">Replacing NPC Models - Mini-Tutorial &amp; Discovery Log</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/general-development/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>General Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Pixelblast Media LLC'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/b/b4f2bc6e5e04e842eae8b788313c606f873a973b.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/Admiral_Sakai.html'><span itemprop='name'>Admiral_Sakai</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="62109.html">

            <link itemprop="image" href="../../uploads/default/original/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d.jpg">

          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-01-23T23:52:58Z' class='post-time'>
                January 23, 2019, 11:52pm
              </time>
              <meta itemprop='dateModified' content='2019-01-23T23:52:58Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><div class="lightbox-wrapper"><a class="lightbox" href="../../uploads/default/original/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d.jpg" data-download-href="https://leakfree.org/uploads/default/d0483a45db940fcc543dcbe038100e555db1af2d" title="20190123145124_1"><img src="../../uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_690x388.jpg" alt="20190123145124_1" data-base62-sha1="tIy3LQmAP2LV2yFZuDVnuZb8ctD" width="690" height="388" srcset="https://leakfree.org/uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_690x388.jpeg, https://leakfree.org/uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_1035x582.jpeg 1.5x, https://leakfree.org/uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_1380x776.jpeg 2x" data-small-upload="../../uploads/default/optimized/2X/d/d0483a45db940fcc543dcbe038100e555db1af2d_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">20190123145124_1</span><span class="informations">1920×1080 351 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>This Xen-bloodied guard is the first thing I’ve done with a technique I’ve just discovered for replacing the character models on NPCs by keyvalue- i.e., using values settable on an NPC-by-NPC basis in the hammer editor.</p>
<p>Those of you familiar with Black Mesa modding will be aware that this can already be done with the character manifest, a script file that the game consults and, if it finds a name matching the NPC in the map, will give the NPC features as described in the entry in the file. This is used to set hair, glasses, face shapes, etc., and can in fact set the body model of the NPC. In the vanilla game this is mostly just used to switch between the normal (clean) and ‘hurt’ (bloody) models for scientists and security guards, but you can put any model you want in there and have, for instance, an entity that is programmatically a security guard and will use a guard’s AI and dialogue, but looks like a Marine and has a Marine’s animations- or a completely custom model you made yourself. Azure Sheep uses this functionality to make its ‘maintenance worker’ and ‘Barniel’ NPCs by putting a custom model over a security guard or a security model over a female scientist, respectively.</p>
<p>The problem is that the character manifest does not integrate well with the Workshop mod download system and cannot just reference multiple files the way, say, a map list can. This means you have to manually install mods which modify it, and additionally multiple mods which do so must be manually merged in a text editor else they will overwrite each other. This is not a problem for Azure Sheep which uses its own executable to launch and (I <em>think</em>!) inserts a separate game path entirely, but for a plug-and-play mod like pre-disaster is just not workable.</p>
<p>However, there is a work-around that allows the model an NPC uses to be specified in the Hammer editor <em>within a specific map</em>. This will <em>override</em> the default model of the NPC and also any model specified in the character manifest. All you need to do is turn off the “smart-edit” option in the NPC’s properties window and add a key with the name “model” and the value “/path/to/your/model”- for instance, the guard above has models/humans/guard_xend.mdl, which is just the guard_hurt model with a different texture where the red blood has been turned yellow. That’s really all there is to it.</p>
<p>A few things I am still looking into:</p>
<ul>
<li>I think the Hammer editor will in many circumstances fail to preserve the added model keyvalue over things like changing the entity class. This is kind of annoying but I don’t think will occur super-commonly so I am tempted to just live with it. Might be possible to add this keyvalue more formally by modifying the game’s FGD.</li>
<li>One thing to look out for is that not all models have the same animations, and sometimes the NPC you’ve changed the model of will try to programmatically call an animation its new model doesn’t have. I remember there being problems specifically with security guards and soldiers having different run animations and thus being unable to move. I haven’t tested this but in theory if you make a new model with animations that have the same names the NPC will work properly. Since many NPCs have the same skeleton to them it may even be possible to directly copy animation files while making the model.</li>
<li>I am not sure how character-manifest-defined bodygroup elements (hair, glasses, face flex, etc) react when the model of the NPC is changed, or if it is possible to change elements from either the old or new model by adding some other keyvalues in Hammer.</li>
<li>It is actually possible to change NPC models semi-dynamically in the game engine by firing the “addoutput” input at them with a new “model /path/to/model” parameter. However, this requires the game to be saved and reloaded to take effect, so I do not think it’ll find much use. It’s <em>possible</em> the engine can be commanded to update those models and only those models in a timely manner through, say, a console command, but I doubt it.</li>
</ul>
<p>On the other hand, though, this has opened up a number of new directions for Black Mesa modding to take:</p>
<ul>
<li><strong>It will now be possible to add construction worker, office worker, and other NPCs to Pre-Disaster maps, as well as ‘Otis’ model security guards if someone ever makes a model for them. This was possible before, but only by using the compatibility-breaking overrides to the character manifest.</strong></li>
<li>If I can get the animation issues ironed out (or just have them standing still) I can now add friendly Marine NPCs to high-security areas of the facility who will respond like security guards when talked to.</li>
<li>It is now possible to add fully-functional office worker, construction worker, and other models to canon BM maps just by editing the maps themselves- this means that incompatibility issues will only arise if another mod edits <em>those specific maps</em>, not any other mod trying to edit any other elements of the character manifest.</li>
<li>Opposing Force remake authors can now make HECU NPCs who will follow the player like guards would, and Black-Ops NPCs who are reskinned Marines. This was possible before, but not in a workshop-compatible</li>
<li>Similarly, this simplifies somewhat the modifications that would be required to add female versions of guard or Marine NPCs and makes them workshop-supportable. However such NPCs would still have the male combat/idle dialogue. I <em>think</em> it might be possible to use response contexts and custom soundscape files to replace dialogue wholesale, but I don’t know for sure.</li>
</ul>
        </div>

        <meta itemprop='headline' content='Replacing NPC Models - Mini-Tutorial &amp; Discovery Log'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Pixelblast Media LLC'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/b/b4f2bc6e5e04e842eae8b788313c606f873a973b.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/darkone.html'><span itemprop='name'>darkone</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="62109.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-01-24T01:34:20Z' class='post-time'>
                January 24, 2019,  1:34am
              </time>
              <meta itemprop='dateModified' content='2019-01-24T01:34:20Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Zen blood covered guards… why isn’t that something in the base game, I mean hunter in the lambda lab would seem more like a bad ass if they where covered in blood and looked like they have been through hell.</p>
<p>Maybe with a bloody and shot vest on the ground, them not having their vest.</p>
<p>Think that was the name of that guard.</p>
        </div>

        <meta itemprop='headline' content='Replacing NPC Models - Mini-Tutorial &amp; Discovery Log'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Pixelblast Media LLC'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/b/b4f2bc6e5e04e842eae8b788313c606f873a973b.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/Admiral_Sakai.html'><span itemprop='name'>Admiral_Sakai</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="62109.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-01-28T18:24:09Z' class='post-time'>
                January 28, 2019,  6:24pm
              </time>
              <meta itemprop='dateModified' content='2019-01-28T18:24:09Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Discovered a slight limitation: for this trick to work, NPCs must be given a name corresponding to an entry in the character manifest file which does <em>not</em> specify its own model line- a character manifest entry with a model, or no name at all, or a name that doesn’t correspond to any character_manifest entry, will not work. So until I can find out more, it would be a good idea to check the character manifest for any NPCs you are planning to remodel and make sure they do not have a model specified.</p>
        </div>

        <meta itemprop='headline' content='Replacing NPC Models - Mini-Tutorial &amp; Discovery Log'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <div class="headerNotice">
    <div class="headerNoticeWrapper wrap">
        <p>Founded in 2004, Leakfree.org became one of the first online communities dedicated to Valve’s Source engine development. It is more famously known for the formation of Black Mesa: Source under the 'Leakfree Modification Team' handle in September 2004.</p>
    </div>
</div>
    
  </body>
  

<!-- Mirrored from leakfree.org/t/replacing-npc-models-mini-tutorial-discovery-log/62109 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 18 Jan 2021 09:24:15 GMT -->
</html>
